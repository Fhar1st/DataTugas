---
title: "INLA"
author: "Farik Firsteadi Haristiyanto"
date: "`r Sys.Date()`"
output: html_document
---

## Eksplorasi Data

```{r}
library(raster)
library(spdep)
library(sp)
library(readxl)
library(openxlsx)
library(rgdal)
library(corrplot)
library(DescTools)
library(nortest)
library(car)
library(spatialreg)
library(corrplot)
library(rio)
```

Berikut ini adalah data dengan peubah-peubah sebagai berikut:

Y = Persentase Kemiskinan per Provinsi; X1 = Indeks Pembangunan Manusia; X2 = Tingkat Pengangguran Terbuka (%); X3 = Raju-rata Laju Pertumbuhan Penduduk; X4 = Gini Ratio; X5 = Pengeluaran per Kapita (Rp 1.000.000,-); serta diberikan juga peta Indonesia.

```{r}
data <- import("https://raw.githubusercontent.com/Fhar1st/DataTugas/main/PSB/IPM%20Kalimantan.csv")
colnames(data) <- c("Provinsi","y","x1","x2","x3","x4","x5","x6","x7")

str(data)
dim(data)
head(data)
```

### Distribusi Data Pengamatan

#### Cek Missing Value

```{r}
data[!complete.cases(data),]
```

Pada data dengan 56 baris yang digunakan tidak terdapat data yang hilang.

#### Summary Data

```{r}
summary(data[,-1])
```

#### Boxplot

```{r}
par(mfrow=c(1,4))
boxplot(data$y,main = "Boxplot IPM")
boxplot(data$x1,main = "Boxplot AHH")
boxplot(data$x2,main = "Boxplot IKP")
boxplot(data$x3,main = "Boxplot II")
boxplot(data$x4,main = "Boxplot LPP")
boxplot(data$x5,main = "Boxplot PDRB ADHB")
boxplot(data$x6,main = "Boxplot PTP")
boxplot(data$x7,main = "Boxplot RLS")
```

Dari keenam boxplot dapat diamati bahwa peubah Tingkat Pengangguran Terbuka (x2) dan Gini Ratio (x4) tidak memiliki suatu data pencilan.

#### Scatter Plot

```{r}
library(DescTools)
pairs(data[,2:9], pch = 19, lower.panel = NULL)
corrplot.mixed(cor(data[,2:9]), upper = "number", lower = "circle")
```

Pada scatter plot, dapat diperhatikan bahwa terdapat korelasi negatif paling signifikan dapat ditemukan di antara peubah respon y dengan peubah penjelas x1, dan di antara peubah x1 dan x5. Sementara korelasi positif yang signifikan dapat ditemukan di antara peubah x1 dengan peubah x2 dan x5, serta di antara peubah x2 dan x5.

### Sebaran Spasial Data Pengamatan

### Kalimantan Barat

```{r warning=FALSE}
petaKB <- readOGR(dsn ="C:/Users/faeri/OneDrive/Documents/Statistika/Semester 6/Pengantar Statistika Bayes STA 1312/Kelompok 2/SHP Kalimantan Barat")
petaKB$Kabupaten

dataKB <- data[-c(15:56),]
```

```{r}
k=101
colfunc <- colorRampPalette(c("blue", "green", "yellow","red"))
color <- colfunc(k)
petaKB$y <- dataKB$y
spplot(petaKB, "y", col.regions=color)
```

### Kalimantan Tengah

```{r warning=FALSE}
petaKTg <- readOGR(dsn ="C:/Users/faeri/OneDrive/Documents/Statistika/Semester 6/Pengantar Statistika Bayes STA 1312/Kelompok 2/SHP Kalimantan Tengah")
petaKTg$Kabupaten

dataKTg <- data[c(15:28),]
```

```{r}
k=101
colfunc <- colorRampPalette(c("blue", "green", "yellow","red"))
color <- colfunc(k)
petaKTg$y <- dataKTg$y
spplot(petaKTg, "y", col.regions=color)
```

### Kalimantan Selatan

```{r warning=FALSE}
petaKS <- readOGR(dsn ="C:/Users/faeri/OneDrive/Documents/Statistika/Semester 6/Pengantar Statistika Bayes STA 1312/Kelompok 2/SHP Kalimantan Selatan")
petaKS$Kabupaten

dataKS <- data[c(29:41),]
```

```{r}
k=101
colfunc <- colorRampPalette(c("blue", "green", "yellow","red"))
color <- colfunc(k)
petaKS$y <- dataKS$y
spplot(petaKS, "y", col.regions=color)
```

